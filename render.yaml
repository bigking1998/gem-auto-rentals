services:
  - type: web
    name: gem-auto-rentals-server
    env: node
    plan: free
    region: oregon 
    buildCommand: pnpm install && pnpm run db:generate && pnpm run db:push && pnpm --filter server run build
    startCommand: node server/dist/index.js
    envVars:
      - key: NPM_CONFIG_PRODUCTION
        value: false
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000
      - key: WEB_URL
        value: https://gemrentalcars.com
      - key: ADMIN_URL
        value: https://admin.gemrentalcars.com
      - key: DATABASE_URL
        sync: false
      - key: DIRECT_URL
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: JWT_EXPIRES_IN
        value: 7d
      - key: R2_ACCOUNT_ID
        sync: false
      - key: R2_ACCESS_KEY_ID
        sync: false
      - key: R2_SECRET_ACCESS_KEY
        sync: false
      - key: R2_PUBLIC_URL
        sync: false
      - key: RESEND_API_KEY
        sync: false
      - key: FROM_EMAIL
        value: "Gem Auto Rentals <noreply@gemrentalcars.com>"
      - key: STRIPE_SECRET_KEY
        sync: false
      - key: STRIPE_WEBHOOK_SECRET
        sync: false
